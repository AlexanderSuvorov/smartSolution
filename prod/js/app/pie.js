define(["d3"],function(t){var a={transformData:function(t,a){var e=[],r=[],n=0;t.forEach(function(t){e[t[a]]?e[t[a]]+=1:e[t[a]]=1,n++});for(var c=0;c<Object.keys(e).length;c++){var s=e[Object.keys(e)[c]]/n*100;r[c]=[],r[c][a]=Object.keys(e)[c],r[c].count=s}return r},drawPie:function(a,e){var r=t.select("body").append("section").attr("id","piechart");r.append("h2").text("Ratio by "+e);var n=500,c=500,s=t.scale.category10();a=this.transformData(a,e);var i=Math.min(c-2,n-2)/2,o=t.svg.arc().outerRadius(i).innerRadius(0),l=t.layout.pie().sort(null).value(function(t){return t.count}),d=t.select("#piechart").append("svg").attr("class","axis").attr("width",c).attr("height",n).append("g").attr("transform","translate("+c/2+","+n/2+")"),u=d.selectAll(".arc").data(l(a)).enter().append("g").attr("class","arc");u.append("path").attr("d",o).style("fill",function(t){return s(t.data[e])}),u.append("text").attr("transform",function(t){return"translate("+o.centroid(t)+")"}).style("text-anchor","middle").text(function(t){return t.data.count+"%"});var p=t.select("#piechart").append("ul").attr("class","map"),f=p.selectAll(".tag").data(l(a)).enter().append("li").attr("class","tag").text(function(t){return t.data[e]});f.append("span").style("background-color",function(t){return s(t.data[e])})}};return a});